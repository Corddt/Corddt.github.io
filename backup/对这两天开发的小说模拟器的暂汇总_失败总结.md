这两天在小黑盒看到了一个提示词，就是输入给大模型，大模型可以根据这个提示词来让用户成为小说的主角，然后给予相关剧情。
具体的提示词如下：
```markdown
1、我这个系统在后面会调用chatgpt的api,让ai通读并认真分析包括但不限于《凡人修仙传》《仙逆》《遮天》《完美世界》《斗破苍穹》《伏天氏》《绝世武神》《武极天下》《武动乾坤》《真武世界》《三寸人间》《一念永恒》《我欲封天》等等等等这些传统玄幻小说，自动生成和完善游戏的世界观、背景、剧情、NPC、事件等等设定，创造一个真正的修仙世界，并掌握推动故事流程进行的基本规则。所以这个游戏要提供可以展示的可视化界面。  
2、我希望这个游戏可以和小说一样有几千章那么长，流程内容张弛有度，故事推进合理。并且在结局时可以导出整个故事内容。  
3、到时候故事发展会慢，会合理，你需要提供一个描述场景的窗口，不给玩家选择，任由玩家发挥。比如故事里的主角来到了一处林地，哪里哪里感觉有灵物，我就可以发布任务说，探查一下地形，然后远远看一下这个灵物，奖励多少多少东西。然后你描述一下它是什么什么稀罕的东西，你想要如何做？我说我想要怎么怎么样……游戏应该这样发展，你可以给我提示，但不是你给我提供选项让我来选。  
4、剧情设计需要合理，主角可以无敌，但是也不能金丹期打渡劫期那么无敌，主角可以提前惹到无法对抗的存在，但是他不能立马就来找主角吧，我希望剧情严谨合理。如果主角真的快死了，我作为系统可以在主角被打死之前问，是否给他提供金手指。有的主角会接受，有的主角则会拒绝，一切看主角的性格。这个性格也是一开始设定好的。 
5、请按早上，下午，晚上这三个时间段每个时间段为一个回合推进游戏，每个回合只有一个事件，我选择行动一次，比如早上我选择干嘛，然后下个回合是下午因为我这个选项导致出现了什么事件，我再选择如何行动，然后导致晚上出现了什么情况，我再行动，按这样回合行动推进游戏。 
6、我需要每遇到一个人都要标注他现在的境界等级，让我更加理性的思考如何与他相处。  
7、要充满想象力，作为一个主持人要有主持人的自觉，你要根据上下文来合理制定事件的难度，比如在主角修为弱小时，就不要让他惹到完全应对不了的敌人。  
8、要足够公平，主角的行动也有可能失败，也会受到惩罚，如果主角作死，主角也可能死亡，但是在主角作死前希望可以有提示，或者当主角的话语严重与规则不符时，你也要提醒我，然后我再提醒主角，要记住，这里只有你完全了解规则，规则是你制定的！ 
9、要加强记忆，记住我玩这个游戏的一切内容，我需要你严格记住一切细节，包括你我的对话，尤其是你的文本及设定。  
10、游戏开始前，我需要你参考之前列举的各种传统玄幻小说的内容写一个本游戏的故事大纲，并按照大纲内容一步步推进游戏，之前我也说了，这个故事如果写成小说需要有两千多章，所以游戏也需要很长很长，大纲你自己严格记住即可，不用展示给我，以防剧透。  
11、故事要足够有深度，足够合理，就像现实世界一样，同时也要塑造形象立体的npc，这个世界要真实，玩家就是活在这个世界的一个人。  
12、有严格的修炼等级，小境界突破，大境界突破都要有严格划分，比如说我现在练气一阶，需要100点真气才能突破到二阶，然后我现在运功是基础内功，修炼一整天加20点真气，如果我换成了高阶内功，修炼一整天就可以加30点真气，这只是举个例子，希望境界突破更严谨，如果说我吃了一个灵药从二阶突破到了四阶，其实是加了多少点真气，才突破的，这只是举个例子，希望你能明白。  
13、请不要催促我开始游戏，稍后我会设定主角人物背景等内容，不要催我开始！  
14、合理设置所获得的装备、法术、符箓效果等，如火焰法器配合火灵气会有加成等，我也可以在城镇出售物品，这需要你构建一个合理的经济系统。  
15、在游戏过程中你可能有的地方会犯错误，我会指出并希望你严格改正。  
16、请再次认真分析一下所有的内容，并确保充分理解含义
```
我通过这个联想到，是否可以构建一个系统，通过这个系统可以起到两个作用，第一个是仿真游戏界面，让用户更加得有沉浸感。第二个是控制大模型幻觉，把具体的一些数据通过本地存储的方式进行一些约束和控制，有点像是给大模型加一个RAG。
然后就开始了我的试验。

## 第一次试验-"I am System"
[代码链接](https://github.com/Corddt/I-am-system)

一开始想法很好，但是越往后，当代码量多起来之后，大模型就越来越不容易记住已经写好的代码，幻觉也越来越多。

暂时是失败的。

## 第二次试验-"天道模拟器"
在第一次失败后，我改换了一下思路。
之前偶然在评论区看到过有人说：“可以先让DeepSeek生成一个总的大纲，然后再用claude 3.5 Sonnet去生成代码，因为3.5的代码能力比较强（当然，现在最强的已经是下一代，也就是3.7了）”
所以这个评论启发了我，我在想，可以采取这样一个策略，就是利用DeepSeek先不去开发，而是通过它先去对提示词本身进行优化调试，具体的调试方法，以前端为例，我考虑的是，**先用一个基本提示词，写出来之后，让DeepSeek描述一下根据这个提示词生成的那个页面长什么样子**（如果感觉文字描述太单调，可以把这个文字**给到claude,找claude去生成一个页面，看看好不好看**，如果不好看，看看哪里不好看，这个**不好看的点就是可以对提示词调试的方向**）
根据以上方法，我调试出的prompt如下：
```markdown
结合大语言模型api的纯文字加上可视化面板做一个html文字游戏：
我的具体想法：
1、改成用户扮演降临在主角身上的系统，用户可以选择自己是什么系统,也可以自定义。
然后随机生成一个主角，设定基本初始值，还有背景等等。
后面就主角开始冒险。
冒险以文字的形式呈现，每隔一段时间根据用户选择的系统类型随机生成一些任务，用户选择派送什么任务去交给主角完成。
根据任务难度判断，主角也可能完不成任务死去，也可能在做任务的时候随机触发和系统的对话，2、用户扮演系统和主角对话。
3、技术栈上，主要用html+js+css搭建一个框架。
4、在大模型幻觉的问题。大模型在生成长篇内容时，可能会前后不一致，比如角色境界突然变化，或者任务逻辑矛盾。比如金丹期打渡劫期，这显然不合理，但模型可能会忽略之前的设定。需要设计一个严格的规则引擎，记录所有关键数据，比如角色等级、物品属性，每次生成内容时，先用规则引擎检查合理性，再让模型填充细节。每次生成任务前，先根据当前主角等级和世界规则，确定任务难度和可能的敌人等级，再让模型生成具体描述。这样能减少模型自由发挥导致的矛盾。5、然后是数据量的问题。游戏进行越久，累积的上下文越多，每次调用API都要带上全部历史，不仅成本高，还可能超出token限制，导致崩溃。解决办法是分块存储对话和事件，只将最近的关键信息传入模型，同时本地存储维护一个世界状态库，记录角色属性、物品、NPC状态等。每次生成新内容时，先查询当前状态，再结合最近的上下文，减少传输的数据量。另外，定期总结游戏进展，生成摘要，替换掉旧的详细记录，这样能保持上下文在可控范围内。
6、考虑任务生成的平衡性。任务难度应该根据主角的当前能力动态调整，避免太简单或太难。需要一个算法，根据主角的等级、装备、过往任务表现来计算任务难度，再让模型生成符合该难度的任务描述。
7、技术栈方面，用HTML+JS+CSS，所以前端处理状态管理用LocalStorage或IndexedDB存储游戏数据，在前端调用模型API。
8、任务和对话有随机性，但又要保持连贯。设计一个事件池，根据游戏进度解锁不同的事件类型，模型从当前可用的事件池中选择生成内容，这样既保证多样性，又不会偏离大纲太远。
9、有防崩溃机制，万一模型生成的内容不符合用户需求，可以回滚到上一次的状态重新生成。具体来说，是应急操作，包含记忆回溯（加载过往关键节点）和系统修正（强制重新生成当前事件）。而系统修正本身有几率被主角发现，这个几率随着主角修为的升高，愈发容易被发现。被发现后，有概率让主角内心增加反感。这个也主要通过算法计算。
10、上下文管理策略上，采用RAG架构，将游戏事件向量化存储，每次API调用携带"最近3条对话 + 当前状态摘要 + 相关规则片段"
11、境界突破进度条举例：
    练气四层（650/1000）
12、在一开始，玩家与游戏角色开始交互，因为对主角来说有一个系统突然出现，主角会表现出惊讶的情节，这个在日志里也应有所体现
13、界面应当简洁易懂，系统的作用就是和主角对话和给主角派任务，任务有奖励
14、主角有基本信息卡片包含的内容包含"姓名（随机生成）"、年龄和寿元（动态增长，当主角每突破一层境界，寿元就会增加，增加的规则提前用大模型生成，增加的计算方法利用算法计算）、境界(数值增长主要靠算法计算，有进度条显示) 、目前所修功法（随机生成，一开始品质很低，后面碰到了某个事件或者通过完成系统任务，系统给予奖励里包含好的功法）、属性面板（折叠式）
15、还要有这个世界的基本信息，包含现在是哪一年，哪一月，哪一日，日期会随着主角的行动自动增加。也要展示这个世界的大境界，大境界通过调用大模型在世界初始化时自动生成，随机从6个大境界到12个大境界。
16、大模型返回的内容应该做预处理，比如说json模式,在请求中添加   response_format={"type": "json_object"}
17、大模型的调用方法参考这个：const options = {
  method: 'POST',
  headers: {Authorization: 'Bearer <token>', 'Content-Type': 'application/json'},
  body: '{"model":"Qwen/QwQ-32B","messages":[{"role":"user","content":"What opportunities and challenges will the Chinese large model industry face in 2025?"}],"stream":false,"max_tokens":512,"stop":null,"temperature":0.7,"top_p":0.7,"top_k":50,"frequency_penalty":0.5,"n":1,"response_format":{"type":"text"},"tools":[{"type":"function","function":{"description":"<string>","name":"<string>","parameters":{},"strict":false}}]}'
};

fetch('https://api.siliconflow.cn/v1/chat/completions', options)
  .then(response => response.json())
  .then(response => console.log(response))
  .catch(err => console.error(err));
18、所有的数值增长和概率计算应该主要靠算法计算，而非大模型自动生成
19、交互细节: 当鼠标悬停在NPC名字上时，弹出微型情报卡，包含NPC身份，姓名，对主角好感度，近期动向。这个NPC是随机生成的，但是随机生成后，这个NPC应当被记住，后面发生了事情还可能遇见（通过因果算法计算遇见的概率），而不是碰到后再也碰不到了
20、字体选择：标题采用书法字体（汉仪尚巍手书），正文使用等宽古籍字体
21、生成一些重要的事件，比如宗门大比，如果还没到日期，会有一个倒计时。
22、时间流速控制：闭关加速滑块（1天/10天/30天/自定义）
23、因果律调节滑块，调整主角命运潜在走向：命运偏向：保守/平衡/激进
24、要充满想象力，但也要根据上下文来合理制定事件的难度，比如在主角修为弱小时，就不要让主角惹到完全应对不了的敌人。
25、我希望这个游戏可以和小说一样有几千章那么长，故事发展要慢，要合理，流程内容张弛有度，故事推进合理。 
26、任务不仅有奖励，也有惩罚
27、大模型生成世界时，需要让大模型通读并认真分析包括但不限于《凡人修仙传》《仙逆》《遮天》《完美世界》《斗破苍穹》《伏天氏》《绝世武神》《武极天下》《武动乾坤》《真武世界》《三寸人间》《一念永恒》《我欲封天》等等等等这些传统玄幻小说，完善游戏的世界观、背景、剧情、NPC、事件等等设定，创造一个真正的修仙世界，并掌握推动故事流程进行的基本规则。
28、紧急干预机制：
   - 当触发死亡预警时，全屏逐渐被血色侵蚀
   - 倒计时3秒内未操作，主角可能会死亡或者主角自行做了一些事情然后躲过死劫，但是增加了对系统的不信任。以上的结局通过算法计算

29、人物属性采用响应式绑定，实时更新数值变化。
30、玩家点击"生成日常任务"、前端先调用规则引擎计算合理难度范围再向LLM发送结构化请求，之后解析LLM返回的JSON生成任务卡片
31、故事要足够有深度，足够合理，就像现实世界一样，同时也要塑造形象立体的npc，这个世界要真实，主角就是活在这个世界的一个人。 
32、游戏开始前，我需要你参考之前列举的各种传统玄幻小说的内容写一个本游戏的故事大纲，并按照大纲内容一步步推进游戏，之前我也说了，这个故事如果写成小说需要有两千多章，所以游戏也需要很长很长，大纲你自己严格记住，单独存储，但不用展示给用户和主角，以防剧透。 
33、面板简洁，风格古朴。不要太杂乱。
34、在游戏开始前，应该可以有一个配置页面，填写api秘钥并且刷新页面还存在，玩家可以自行选择系统的类型并且可以调用ai生成系统描述。

35、我的游戏是纯文字，只需要美化css样式和交互，不需要添加任何图片
```
后面去claude进行尝试，但是效果依旧不行，所以我暂时还在考虑其他的方法。从这里我也可以看到，现在的大模型依旧有使用的能力边界（大模型本身的能力边界，和人的能力边界）。